---
title: "PEC 1. Análisis de datos ómicos"
author: "Joaquín Vila García"
date: "2024-11-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

El enlace al repositorio de GitHub en el que se almacenan los archivos de esta PEC es:

<https://github.com/normoblasto/Vila-Garcia-Joaquin-PEC1>

El dataset de metabolómica elegido para esta PEC es 2024-fobitools-UseCase_1, del repositorio "<https://github.com/nutrimetabolomics/metaboData/>" de GitHUb. Como se puede leer en la descripción, este paquete está sacado de Metabolomics Workbench (ID ST000291). Está basado en un estudio realizado para analizar las diferencias metabolómicas en la orina de mujeres jóvenes después de beber jugo de arándano o jugo de manzana.

Lo primero que haremos será instalar y cargar el paquete *SummarizedExperiment*:

```{r}
# Instalación del paquete SummarizedExperiment
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("SummarizedExperiment")

# Carga del paquete SummarizedExperiment
library(SummarizedExperiment)

# Instalación del paquete metabolomicsWorkbenchR
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("metabolomicsWorkbenchR")

# Carga del paquete metabolomicsWorkbenchR
library(metabolomicsWorkbenchR)

# Carga del paquete readr
library(readr)
```

Posteriormente cargamos el dataset elegido (2024-fobitools-UseCase_1):

```{r}
# Cargar los datos de características (1541 variables x 45 muestras)
features <- read_csv2("https://raw.githubusercontent.com/normoblasto/Vila-Garcia-Joaquin-PEC1/main/2024-fobitools-UseCase_1/features.csv")
head(features)

# Cargar los metadatos (45 muestras con 2 columnas)
metadata <- read.csv2("https://raw.githubusercontent.com/normoblasto/Vila-Garcia-Joaquin-PEC1/main/2024-fobitools-UseCase_1/metadata.csv",  header = TRUE, row.names = 1)
head(metadata)

# Cargar los nombres de metabolitos (1541 variables con 3 columnas)
metabolite_names <- read.csv2("https://raw.githubusercontent.com/normoblasto/Vila-Garcia-Joaquin-PEC1/main/2024-fobitools-UseCase_1/metaboliteNames.csv",  header = TRUE, row.names = 1)
head(metabolite_names)
```

```{r}
# Convertir los datos de características a formato matriz
assay_data <- as.matrix(features)

# nombres de las filas (metabolitos)
row_data <- DataFrame(metabolite_names[, 1])
head(row_data)

# nombres de las columnas
col_data <- DataFrame(sample_metadata[,1])
head(col_data)
```

```{r}
# Creamos el objeto SummarizedExperiment usando los valores arriba seleccionados
se <- SummarizedExperiment(assays = list(counts = assay_data),
                           rowData = row_data,
                           colData = col_data)
```

Guardamos el archivo "SummarizedExperimentData.Rda":

```{r}
save(se, file = "SummarizedExperimentData.Rda")

```

Ahora haremos una breve exploración del objeto SummarizedExperiment que hemos creado.

```{r}
# Cargar el archivo
load("SummarizedExperimentData.Rda")

# Revisar la estructura general del objeto
se
```

Vemos que la clase del archivo es SummarizedExperiment y que tiene una dimensión de 1541x45. Es decir, se han medido 1541 metabolitos en un total de 45 muestras.

Vemos que "metadata(0)", con lo que no hemos almacenado información adicional como metadatos.

Las columnas están etiquetadas con nombres que representan las muestras individuales (b1, b10, etc.). Esto indica que hay 45 muestras únicas en este experimento.

Más en detalle:

```{r}
# Ver los metadatos de las muestras
colData(se)

# Resumen de las columnas en `colData`
summary(colData(se))
```

```{r}
# Ver los metadatos de las variables
rowData(se)

# Primeras filas de `rowData`
head(rowData(se))
```

RowData contiene los nombres de los metabolitos analizados.
